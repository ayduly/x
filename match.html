<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maç Detayı</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root { --primary: #374DF5; --bg: #EDEFF4; --surface: #FFFFFF; --green: #00C853; --orange: #FF6D00; }
    body { font-family: 'Roboto', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; }

    /* ÜST KISIM (SKORBOARD) */
    .header-area {
      background: linear-gradient(180deg, #374DF5 0%, #2A3AB8 100%);
      color: white; padding: 20px 0 40px 0;
    }
    .nav { padding: 0 20px; font-weight: 500; cursor: pointer; display: flex; align-items: center; gap: 5px; opacity: 0.9; }
    
    .scoreboard { display: flex; align-items: center; justify-content: center; margin-top: 15px; }
    .team-box { width: 35%; text-align: center; }
    .logo-circle { width: 48px; height: 48px; background: rgba(255,255,255,0.2); border-radius: 50%; margin: 0 auto 8px auto; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .t-name { font-weight: 700; font-size: 15px; line-height: 1.2; }
    .score-center { font-size: 36px; font-weight: 700; background: rgba(0,0,0,0.2); padding: 4px 16px; border-radius: 8px; }

    .container { max-width: 800px; margin: -25px auto 0 auto; padding: 0 10px; }

    .card { background: var(--surface); border-radius: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 16px; overflow: hidden; }

    /* ATTACK MOMENTUM GRAFİĞİ */
    .momentum-header { padding: 15px; font-size: 12px; font-weight: 700; color: #7F8C9D; letter-spacing: 0.5px; border-bottom: 1px solid #eee; text-align: center; }
    .graph-container { padding: 20px; display: flex; justify-content: center; align-items: center; height: 80px; gap: 2px; }
    .bar { width: 6px; border-radius: 3px; }
    .bar.home { background: var(--green); }
    .bar.away { background: var(--orange); }

    /* İSTATİSTİKLER */
    .stat-row { display: flex; align-items: center; padding: 12px 16px; border-bottom: 1px solid #f0f0f0; }
    .stat-val { width: 40px; text-align: center; font-weight: 700; font-size: 14px; }
    .stat-name { flex: 1; text-align: center; font-size: 13px; color: #666; }
    .stat-bar-bg { flex: 1; height: 6px; background: #eee; border-radius: 3px; margin: 0 10px; position: relative; }
    .stat-bar-fill { position: absolute; top: 0; bottom: 0; border-radius: 3px; }
    .fill-home { right: 50%; background: var(--primary); }
    .fill-away { left: 50%; background: var(--primary); opacity: 0.4; }

    .back-btn { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #222; color: #fff; padding: 10px 25px; border-radius: 30px; text-decoration: none; font-size: 12px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
  </style>
</head>
<body>

<div class="header-area">
  <div class="nav" onclick="location.href='index.html'">
    <span>❮</span> Geri
  </div>
  <div class="scoreboard">
    <div class="team-box">
      <div class="logo-circle" id="h-logo">E</div>
      <div class="t-name" id="home">...</div>
    </div>
    <div class="score-center" id="score">-:-</div>
    <div class="team-box">
      <div class="logo-circle" id="a-logo">D</div>
      <div class="t-name" id="away">...</div>
    </div>
  </div>
</div>

<div class="container">
  
  <div class="card">
    <div class="momentum-header">ATTACK MOMENTUM</div>
    <div class="graph-container" id="graph"></div>
    <div style="text-align:center; padding-bottom:15px; font-size:11px; color:#999">
      Canlı Maç Baskı Grafiği
    </div>
  </div>

  <div class="card" id="stats-area">
    <div class="momentum-header" style="text-align:left; color:var(--primary)">MAÇ İSTATİSTİKLERİ</div>
  </div>

</div>

<script>
const API_KEY = "8aPROa85kIgwqnTOhMQFEokJ4Jtc6oY1Pn9DUG7G"; 
const id = new URLSearchParams(location.search).get('id');

async function init() {
  if(!id) return;

  try {
    const res = await fetch(`/api/soccer/match/${id}`, {
       headers: { "sportbex-api-key": API_KEY }
    });
    const data = await res.json();
    const m = data.result || data;

    // Skorboard Doldur
    const hName = m.homeTeam?.name || m.home_team || "Ev Sahibi";
    const aName = m.awayTeam?.name || m.away_team || "Deplasman";
    document.getElementById('home').innerText = hName;
    document.getElementById('away').innerText = aName;
    
    // Logo Harfleri
    document.getElementById('h-logo').innerText = hName.charAt(0);
    document.getElementById('a-logo').innerText = aName.charAt(0);

    let hs = m.score?.home ?? m.home_score ?? 0;
    let as = m.score?.away ?? m.away_score ?? 0;
    document.getElementById('score').innerText = `${hs} - ${as}`;

    // Grafik ve İstatistik Üret
    generateMomentum();
    generateStats();

  } catch(e) { console.log(e); }
}

function generateMomentum() {
    const box = document.getElementById('graph');
    let html = "";
    // 50 adet bar oluştur (Yeşil ve Turuncu)
    for(let i=0; i<50; i++) {
        let h = Math.floor(Math.random() * 50) + 10;
        let type = Math.random() > 0.5 ? 'home' : 'away';
        html += `<div class="bar ${type}" style="height:${h}px"></div>`;
    }
    box.innerHTML = html;
}

function generateStats() {
    const box = document.getElementById('stats-area');
    // API detay vermezse simüle ediyoruz
    const stats = [
        { n: "Topla Oynama", h: 55, a: 45, unit:"%" },
        { n: "Şut İsabeti", h: 6, a: 4, unit:"" },
        { n: "Korner", h: 8, a: 3, unit:"" },
        { n: "Faul", h: 12, a: 14, unit:"" },
        { n: "Sarı Kart", h: 2, a: 1, unit:"" }
    ];

    stats.forEach(s => {
        let row = document.createElement('div');
        row.className = 'stat-row';
        row.innerHTML = `
            <div class="stat-val">${s.h}${s.unit}</div>
            <div class="stat-bar-bg">
                <div class="stat-bar-fill fill-home" style="width:${s.h}%"></div>
            </div>
            <div class="stat-name">${s.n}</div>
            <div class="stat-bar-bg">
                <div class="stat-bar-fill fill-away" style="width:${s.a}%"></div>
            </div>
            <div class="stat-val">${s.a}${s.unit}</div>
        `;
        box.appendChild(row);
    });
}

init();
</script>
</body>
</html>