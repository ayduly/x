<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ma√ß Detayƒ±</title>
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { 
      --gold: #FFD700; 
      --dark-bg: #0a0a0a; 
      --text: #ffffff; 
    }
    body { 
      font-family: 'Inter', sans-serif; margin: 0; padding: 0; 
      color: var(--text); background: var(--dark-bg);
      background-image: linear-gradient(rgba(0,0,0,0.9), rgba(0,0,0,0.95)), url('https://images.unsplash.com/photo-1518091043644-c1d4457512c6?q=80&w=1000');
      background-size: cover; background-attachment: fixed;
    }

    .header { 
      padding: 40px 20px; text-align: center; 
      background: radial-gradient(circle at center, rgba(255, 215, 0, 0.1) 0%, rgba(10,10,10,0) 70%);
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .scoreboard { display: flex; justify-content: center; align-items: center; gap: 15px; }
    .team-name { font-size: 18px; font-weight: 700; width: 40%; text-shadow: 0 2px 5px rgba(0,0,0,0.5); }
    .score-display { 
      font-family: 'Rajdhani', sans-serif; font-size: 42px; font-weight: 700; 
      color: var(--gold); text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
    }

    .content { max-width: 600px; margin: 0 auto; padding: 20px; }
    
    /* AI Kutusu */
    .ai-box {
      background: linear-gradient(145deg, rgba(30,30,30,0.8), rgba(20,20,20,0.9));
      border: 1px solid rgba(255, 215, 0, 0.3);
      border-radius: 12px; padding: 20px; margin-bottom: 20px;
    }
    .ai-title { color: var(--gold); font-weight: bold; margin-bottom: 10px; }
    .ai-text { font-size: 14px; line-height: 1.6; color: #ddd; }

    /* Market (Basketbol i√ßin) */
    .market-box { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 8px; margin-bottom: 10px; }
    .runner-row { display: flex; justify-content: space-between; font-size: 13px; margin-top:5px; }

    .back-btn { 
      position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); 
      background: #111; border: 1px solid var(--gold); color: var(--gold); 
      padding: 10px 30px; border-radius: 30px; text-decoration: none; 
      font-size: 12px; font-weight: bold;
    }
  </style>
</head>
<body>

<div class="header">
  <div class="scoreboard">
    <div class="team-name" id="home">...</div>
    <div class="score-display" id="score">-:-</div>
    <div class="team-name" id="away">...</div>
  </div>
</div>

<div class="content">
  <div id="ai-area"></div>
  <div id="details-area"></div>
</div>

<a href="index.html" class="back-btn">‚Üê Lƒ∞STEYE D√ñN</a>

<script>
const urlParams = new URLSearchParams(window.location.search);
const matchId = urlParams.get('id');
const sport = urlParams.get('sport') || 'football';
const API_KEY = "8aPROa85kIgwqnTOhMQFEokJ4Jtc6oY1Pn9DUG7G"; 

// Renk Ayarƒ±
if(sport === 'basketball') {
    document.documentElement.style.setProperty('--gold', '#FF9800');
}

init();

async function init() {
  if(!matchId) return;
  const aiArea = document.getElementById('ai-area');
  const detailsArea = document.getElementById('details-area');

  if (sport === 'basketball') {
      // --- BASKETBOL ---
      document.getElementById('score').innerText = "VS";
      
      try {
          const res = await fetch(`/api/basket/markets/7522/${matchId}`, { headers: { "sportbex-api-key": API_KEY } });
          const data = await res.json();
          let markets = Array.isArray(data) ? data : (data.result || []);

          if(markets.length > 0 && markets[0].runners) {
              let hName = markets[0].runners[0]?.runnerName;
              let aName = markets[0].runners[1]?.runnerName;
              document.getElementById('home').innerText = hName;
              document.getElementById('away').innerText = aName;
              
              // Basketbol AI
              aiArea.innerHTML = generateAI(hName, aName, 'Basketbol');
          }

          let html = "";
          markets.forEach(m => {
              html += `<div class="market-box"><div style="color:var(--gold); font-size:12px; font-weight:bold">${m.marketName}</div>`;
              if(m.runners) {
                  m.runners.forEach(r => {
                      html += `<div class="runner-row"><span>${r.runnerName}</span> <span>${r.lastPriceTraded || '-'}</span></div>`;
                  });
              }
              html += `</div>`;
          });
          detailsArea.innerHTML = html;

      } catch (e) { detailsArea.innerHTML = "Veri hatasƒ±."; }

  } else {
      // --- FUTBOL ---
      try {
          const res = await fetch(`/api/sportbex/match/${matchId}`, { headers: { "sportbex-api-key": API_KEY } });
          const data = await res.json();
          const m = data.result || data;
          
          let hName = m.homeTeam?.name || m.home_team || "Ev Sahibi";
          let aName = m.awayTeam?.name || m.away_team || "Deplasman";
          let hs = m.score?.home ?? m.home_score ?? 0;
          let as = m.score?.away ?? m.away_score ?? 0;

          document.getElementById('home').innerText = hName;
          document.getElementById('away').innerText = aName;
          document.getElementById('score').innerText = `${hs}:${as}`;

          // Futbol AI
          aiArea.innerHTML = generateAI(hName, aName, 'Futbol');
          
      } catch(e) { detailsArea.innerHTML = "Veri alƒ±namadƒ±."; }
  }
}

function generateAI(h, a, type) {
    let text = "";
    if(type === 'Futbol') {
        text = `<strong>${h}</strong> son haftalarda evinde etkili. <strong>${a}</strong> ise savunma odaklƒ± √ßƒ±kabilir. Ma√ßta 2.5 √úST gol beklentisi y√ºksek.`;
    } else {
        text = `<strong>${h}</strong> pota altƒ±nda √ºst√ºn g√∂r√ºn√ºyor. <strong>${a}</strong> √º√ßl√ºk y√ºzdesiyle ma√ßa tutunabilir. Y√ºksek skorlu bir ma√ß (160+ sayƒ±) bekleniyor.`;
    }

    return `
    <div class="ai-box">
        <div class="ai-title">ü§ñ AI TAHMƒ∞Nƒ∞ (${type})</div>
        <div class="ai-text">${text}</div>
    </div>`;
}
</script>
</body>
</html>