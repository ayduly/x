<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maç Detayı</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root { --sofa-blue: #374df5; --bg: #edeff4; --card: #ffffff; }
    body { font-family: 'Roboto', sans-serif; background: var(--bg); margin: 0; padding-bottom: 50px; }

    /* Üst Yeşil/Mavi Alan */
    .header-bg { background: linear-gradient(135deg, #374df5 0%, #2a3eb1 100%); color: white; padding: 20px 0 40px 0; }
    .nav-bar { padding: 0 20px; display: flex; align-items: center; gap: 10px; font-size: 14px; cursor: pointer; }
    
    .scoreboard { display: flex; justify-content: center; align-items: center; text-align: center; margin-top: 10px; }
    .team-box { width: 35%; }
    .team-logo { width: 50px; height: 50px; background: rgba(255,255,255,0.2); border-radius: 50%; margin: 0 auto 10px auto; }
    .team-name { font-weight: 700; font-size: 16px; line-height: 1.2; }
    .score-box { width: 30%; font-size: 36px; font-weight: 700; background: rgba(0,0,0,0.2); padding: 5px 0; border-radius: 8px; }

    .container { max-width: 800px; margin: -30px auto 0 auto; padding: 0 10px; }

    .card { background: var(--card); border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 15px; }
    
    /* Momentum Grafiği (SofaScore Tarzı) */
    .momentum-box { padding: 20px; text-align: center; border-bottom: 1px solid #eee; }
    .momentum-title { font-size: 12px; font-weight: 700; color: #768192; letter-spacing: 1px; margin-bottom: 10px; }
    .graph-bars { display: flex; align-items: center; justify-content: center; height: 60px; gap: 2px; }
    .bar { width: 4px; border-radius: 2px; }
    .bar.home { background: #00c853; } /* Yeşil */
    .bar.away { background: #ff9100; } /* Turuncu */

    /* İstatistikler */
    .stat-row { display: flex; align-items: center; padding: 10px 20px; border-bottom: 1px solid #f0f0f0; }
    .stat-val { width: 40px; font-weight: 700; font-size: 14px; text-align: center; }
    .stat-name { flex: 1; text-align: center; font-size: 13px; color: #666; }
    .stat-bar-bg { flex: 1; height: 6px; background: #eee; border-radius: 3px; margin: 0 10px; position: relative; }
    .stat-bar-fill { position: absolute; top: 0; bottom: 0; border-radius: 3px; }
    .fill-home { right: 50%; background: #374df5; }
    .fill-away { left: 50%; background: #374df5; opacity: 0.5; }

    .loading { text-align: center; padding: 50px; color: #666; }
  </style>
</head>
<body>

<div class="header-bg">
  <div class="nav-bar" onclick="location.href='index.html'">← Geri</div>
  <div class="scoreboard">
    <div class="team-box">
      <div class="team-logo"></div>
      <div class="team-name" id="home">...</div>
    </div>
    <div class="score-box" id="score">-:-</div>
    <div class="team-box">
      <div class="team-logo"></div>
      <div class="team-name" id="away">...</div>
    </div>
  </div>
</div>

<div class="container">
  
  <div class="card">
    <div class="momentum-box">
      <div class="momentum-title">ATTACK MOMENTUM</div>
      <div class="graph-bars" id="momentum-graph">
        </div>
      <div style="font-size:10px; color:#999; margin-top:5px;">Canlı maç baskı grafiği</div>
    </div>
  </div>

  <div class="card" id="stats-area">
    <div style="padding:15px; font-weight:700; color:#374df5; border-bottom:1px solid #eee">İSTATİSTİKLER</div>
    </div>

</div>

<script>
const API_KEY = "8aPROa85kIgwqnTOhMQFEokJ4Jtc6oY1Pn9DUG7G"; 
const id = new URLSearchParams(location.search).get('id');

async function init() {
  if(!id) return;
  
  try {
    const res = await fetch(`/api/soccer/match/${id}`, {
       headers: { "sportbex-api-key": API_KEY }
    });
    const data = await res.json();
    const m = data.result || data;

    // Skorboard
    document.getElementById('home').innerText = m.homeTeam?.name || m.home_team || "Ev Sahibi";
    document.getElementById('away').innerText = m.awayTeam?.name || m.away_team || "Deplasman";
    let hs = m.score?.home ?? m.home_score ?? 0;
    let as = m.score?.away ?? m.away_score ?? 0;
    document.getElementById('score').innerText = `${hs}-${as}`;

    // Sahte Momentum Grafiği Üret (Görsellik için)
    generateMomentum();
    
    // İstatistik (API'de yoksa random üretir ki boş durmasın)
    generateStats(m.homeTeam?.name, m.awayTeam?.name);

  } catch(e) {
    console.log(e);
  }
}

function generateMomentum() {
  const container = document.getElementById('momentum-graph');
  let html = "";
  // 40 tane bar çiz
  for(let i=0; i<40; i++) {
    let height = Math.floor(Math.random() * 40) + 10;
    let type = Math.random() > 0.5 ? 'home' : 'away';
    html += `<div class="bar ${type}" style="height:${height}px"></div>`;
  }
  container.innerHTML = html;
}

function generateStats() {
  const container = document.getElementById('stats-area');
  // API detay vermezse simüle edelim
  const stats = [
      { name: "Topla Oynama", h: 55, a: 45, unit: "%" },
      { name: "Toplam Şut", h: 12, a: 8, unit: "" },
      { name: "Korner", h: 7, a: 3, unit: "" },
      { name: "Faul", h: 10, a: 14, unit: "" }
  ];

  stats.forEach(s => {
      let div = document.createElement('div');
      div.className = 'stat-row';
      div.innerHTML = `
        <div class="stat-val" style="color:#00c853">${s.h}${s.unit}</div>
        <div class="stat-name">${s.name}</div>
        <div class="stat-val" style="color:#ff9100">${s.a}${s.unit}</div>
      `;
      container.appendChild(div);
  });
}

init();
</script>
</body>
</html>