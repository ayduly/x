<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maç Detayı</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root { --primary: #00E676; --basket: #FF9800; --dark: #121212; --card: #1E1E1E; --text: #E0E0E0; --border: #333; }
    body { font-family: 'Inter', sans-serif; background: var(--dark); color: var(--text); margin: 0; padding: 0; }
    .header { padding: 30px 20px; text-align: center; background: linear-gradient(to bottom, #2c3e50, var(--dark)); border-bottom: 1px solid var(--border); }
    .scoreboard { display: flex; justify-content: center; align-items: center; gap: 20px; margin-top: 10px; }
    .team-name { font-size: 18px; font-weight: bold; width: 40%; }
    .score-display { font-size: 32px; font-weight: 900; color: var(--primary); background: rgba(0,0,0,0.3); padding: 5px 20px; border-radius: 8px; }
    .content { max-width: 600px; margin: 0 auto; padding: 20px; text-align: center; }
    .loading { color: #888; margin-top: 20px; }
    .market-box { background: var(--card); border: 1px solid var(--border); padding: 15px; border-radius: 8px; margin-bottom: 10px; text-align: left; }
    .market-title { font-size: 14px; color: var(--basket); font-weight: bold; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; }
    .runner-row { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 13px; }
    .odds { background: #333; padding: 2px 6px; border-radius: 4px; color: #fff; font-weight: bold; }
    .back-btn { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: var(--card); border: 1px solid var(--border); color: #fff; padding: 10px 25px; border-radius: 30px; text-decoration: none; font-size: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
  </style>
</head>
<body>

<div class="header">
  <div style="font-size: 12px; color: #888; text-transform: uppercase; letter-spacing: 1px;">MAÇ DETAYI</div>
  <div class="scoreboard">
    <div class="team-name" id="home">...</div>
    <div class="score-display" id="score">-:-</div>
    <div class="team-name" id="away">...</div>
  </div>
</div>

<div class="content">
  <div id="details-area">
    <div class="loading">Veriler yükleniyor...</div>
  </div>
</div>
<a href="index.html" class="back-btn">← Listeye Dön</a>

<script>
const urlParams = new URLSearchParams(window.location.search);
const matchId = urlParams.get('id');
const sport = urlParams.get('sport') || 'football';
const API_KEY = "8aPROa85kIgwqnTOhMQFEokJ4Jtc6oY1Pn9DUG7G"; 

async function init() {
  const area = document.getElementById('details-area');
  if(!matchId) { area.innerHTML = "Maç ID bulunamadı."; return; }

  if (sport === 'basketball') {
      document.querySelector('.header').style.background = 'linear-gradient(to bottom, #E65100, #121212)';
      document.getElementById('score').innerText = "VS";
      document.getElementById('home').innerText = "Ev Sahibi"; 
      document.getElementById('away').innerText = "Deplasman";
      
      try {
          const res = await fetch(`/api/basket/markets/7522/${matchId}`, { headers: { "sportbex-api-key": API_KEY } });
          const data = await res.json();
          let markets = Array.isArray(data) ? data : (data.result || []);

          if(markets.length === 0) { area.innerHTML = "Bahis marketi yok."; return; }

          if(markets[0]?.runners?.length >= 2) {
              document.getElementById('home').innerText = markets[0].runners[0]?.runnerName;
              document.getElementById('away').innerText = markets[0].runners[1]?.runnerName;
          }

          let html = "";
          markets.forEach(m => {
              html += `<div class="market-box"><div class="market-title">${m.marketName || 'Market'}</div>`;
              if(m.runners) {
                  m.runners.forEach(r => {
                      html += `<div class="runner-row"><span>${r.runnerName}</span><span class="odds">${r.lastPriceTraded || '-'}</span></div>`;
                  });
              }
              html += `</div>`;
          });
          area.innerHTML = html;
      } catch (e) { area.innerHTML = "Veri hatası: " + e.message; }

  } else {
      try {
          const res = await fetch(`/api/sportbex/match/${matchId}`, { headers: { "sportbex-api-key": API_KEY } });
          const data = await res.json();
          const m = data.result || data; 
          document.getElementById('home').innerText = m.homeTeam?.name || m.home_team || "Ev";
          document.getElementById('away').innerText = m.awayTeam?.name || m.away_team || "Dep";
          let hs = m.score?.home ?? m.home_score ?? 0;
          let as = m.score?.away ?? m.away_score ?? 0;
          document.getElementById('score').innerText = `${hs}:${as}`;
          area.innerHTML = `<div style="color:#aaa; margin-top:20px;">İstatistikler bekleniyor...</div>`;
      } catch(e) { area.innerHTML = "Maç verisi alınamadı."; }
  }
}
init();
</script>
</body>
</html>